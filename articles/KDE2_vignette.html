<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Binary plot with kernel density estimation • ASTR</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Binary plot with kernel density estimation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ASTR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/KDE2_vignette.html">Binary plot with kernel density estimation</a></li>
    <li><a class="dropdown-item" href="../articles/VG.ASTR.Conventions.explained.html">Data conventions explained</a></li>
    <li><a class="dropdown-item" href="../articles/VG.ASTRschema.0.0.2.html">ASTR schema: Naming conventions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Binary plot with kernel density estimation</h1>
            
      

      <div class="d-none name"><code>KDE2_vignette.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://archaeothommy.github.io/ASTR/index.html">ASTR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette introduces <code>geom_kde2()</code>, which generates a
binary plot with kernel density estimation.</p>
<p>Kernel density estimation (KDE) is a non-parametric method to
transform continuous data into a smoothed probability density function.
According to <span class="citation">Y.-K. Hsu (<a href="#ref-Hsu2023">2023</a>)</span> and <span class="citation">Y.-K.
Hsu et al. (<a href="#ref-Hsu2018">2018</a>)</span>, KDE has become
popular in archaeological science publications <span class="citation">(<a href="#ref-Pollard2023">Pollard et al.,
2023</a>)</span> mainly due to three advantages when analysing data:</p>
<ol style="list-style-type: decimal">
<li>They do not assume the normality of the data;</li>
<li>They can produce smoother distributions than conventional
histograms, whose appearance is significantly affected by the choices of
bin width and the start/end points of bins; and</li>
<li>They can represent data in a multidimensional space and enable users
to effectively compare different datasets either graphically or
mathematically (see also <span class="citation">De Ceuster et al. (<a href="#ref-DeCeuster2025">2025</a>)</span> for the advantages of the use
of one-dimensional KDE’s).</li>
</ol>
<div class="section level3">
<h3 id="what-is-kernel-density-estimation-kde">What is Kernel density estimation (KDE)?<a class="anchor" aria-label="anchor" href="#what-is-kernel-density-estimation-kde"></a>
</h3>
<p>Kernel density estimation is a widely-used tool for visualising the
distribution of data <span class="citation">(<a href="#ref-Simonoff1996">Simonoff, 1996</a>)</span>.</p>
<p>Probability density function (pdf) shows how the whole 100%
probability mass is distributed over the x-axis, i.e., over the values
of an X random variable. Kernel estimation of probability density
function produces a smooth empirical pdf based on individual locations
of all sample data. Such pdf estimate seems to better represent the
“true” pdf of a continuous variable <span class="citation">(<a href="#ref-Weglarczyk2018">Węglarczyk, Stanisław, 2018</a>)</span>.</p>
</div>
<div class="section level3">
<h3 id="kernel-density-estimation-calculation">Kernel density estimation calculation<a class="anchor" aria-label="anchor" href="#kernel-density-estimation-calculation"></a>
</h3>
<p>Let the series
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{x_1, x_2, \ldots, x_n\}</annotation></semantics></math>
be an independent and identically distributed (i.i.d.) sample of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
observations taken from a population
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
with an unknown probability distribution function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math>.</p>
<p>The kernel estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}(x)</annotation></semantics></math>
of the original
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math>
assigns each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
sample data point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
a function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K(x_i, t)</annotation></semantics></math>,
called a <em>kernel function</em>, in the following way:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \hat{f}(t) = \frac{1}{n} \sum_{i=1}^{n} K(x_i, t) \tag{1} </annotation></semantics></math></p>
<p>The kernel function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K(x, t)</annotation></semantics></math>
is non-negative and bounded for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>∞</mi><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for all real </mtext><mspace width="0.333em"></mspace></mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow><annotation encoding="application/x-tex"> 0 \leq K(x, t) &lt; \infty \quad \text{for all real } x, t \tag{2} </annotation></semantics></math></p>
<p>and, for all real
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>∞</mi></mrow><mi>∞</mi></msubsup><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mo>=</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex"> \int_{-\infty}^{\infty} K(x, t) \, dt = 1. \tag{3} </annotation></semantics></math></p>
<p>Property (3) ensures the required normalisation of the kernel density
estimate given in (1):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>∞</mi></mrow><mi>∞</mi></msubsup><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>∞</mi></mrow><mi>∞</mi></msubsup><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mo>=</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex"> \int_{-\infty}^{\infty} \hat{f}(t) \, dt = \frac{1}{n} \sum_{i=1}^{n} \int_{-\infty}^{\infty} K(x_i, t) \, dt = 1. \tag{4} </annotation></semantics></math></p>
<p>In other words, the kernel transforms the “<em>sharp</em>” (point)
location of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
into an interval centred (symmetrically or not) around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math><span class="citation">(<a href="#ref-Weglarczyk2018">Węglarczyk,
Stanisław, 2018</a>)</span>.</p>
</div>
<div class="section level3">
<h3 id="function-workflow">Function workflow<a class="anchor" aria-label="anchor" href="#function-workflow"></a>
</h3>
<p><code>geom_kde2()</code> calculates the 2D kernel density estimate
using <code>kde()</code> from the ks package <span class="citation">(<a href="#ref-Duong2007">Duong, 2007</a>, <a href="#ref-Duong2025">2025</a>)</span>, while handling the contours
manually (<code>compute.cont = FALSE</code>). It then calculates the
actual density values (the contour levels) corresponding to the
probability levels (probs) using <code><a href="https://rdrr.io/pkg/ks/man/contour.html" class="external-link">ks::contourLevels()</a></code>.</p>
<p>Using the base R function <code><a href="https://rdrr.io/r/grDevices/contourLines.html" class="external-link">grDevices::contourLines()</a></code>, the
contour line coordinates are generated, using the grid points
(<code>eval.points</code>) and the density estimate
(<code>estimate</code>) from the kde object, and the calculated levels.
The contour coordinates are converted into a data frame as list items.
The function extracts its coordinates (x, y) and assigns a unique group
ID for each contour. Specific error messages are printed for failed
density calculations.</p>
<p>The original data are then returned with the added type column and
are checked for fallback (values in the type column equals to “points”)
to determine if the density estimates failed. A data frame for plotting
points using the original x and y data from the fallback data is
created, applying the determined aesthetics and these are drawn using
the in-built GeomPoint <code>draw_panel</code>.</p>
<p>Default aesthetic values are applied if unchanged by the user.</p>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>The following examples showcase the different visualisation and
density estimate calculations for <code><a href="../reference/geom_kde2d.html">geom_kde2d()</a></code>.</p>
<div class="section level4">
<h4 id="basic-biplot">Basic biplot<a class="anchor" aria-label="anchor" href="#basic-biplot"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load example lead isotope data that is included with the package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ArgentinaDatabase</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">ArgentinaDatabase</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">`206Pb/204Pb`</span>,</span>
<span>    y <span class="op">=</span> <span class="va">`207Pb/204Pb`</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">`Mining site`</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_kde2d.html">geom_kde2d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># move the legend under the plot so the</span></span>
<span>  <span class="co"># site names are fully legible</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span></span>
<span>    nrow <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'</span></span></code></pre></div>
<p><img src="KDE2_vignette_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="" width="672"></p>
<p>This example reads in the sample dataset and calculates the kernel
density estimates in the function <code><a href="../reference/geom_kde2d.html">geom_kde2d()</a></code>, colouring
by the <code>Mining site</code> variable from the dataset. Warning
messages appear for each group where the sample size is too small to
calculate the estimates:
<code>No density estimate possible for group 'x', plotting points instead: the leading minor of order 1 is not positive</code>.
In those cases, the plotting falls back to plotting individual points
from the original dataset.</p>
</div>
<div class="section level4">
<h4 id="biplot-with-adjusted-quantiles-to-show-deciles">Biplot with adjusted quantiles to show deciles<a class="anchor" aria-label="anchor" href="#biplot-with-adjusted-quantiles-to-show-deciles"></a>
</h4>
<p>The default function reverts to 4 quantiles. This examples
illustrates the quantiles set to 10 to show deciles. It also sets the
transparency to 0.5 (<code>alpha</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">ArgentinaDatabase</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">`206Pb/204Pb`</span>,</span>
<span>    y <span class="op">=</span> <span class="va">`207Pb/204Pb`</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">`Mining site`</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_kde2d.html">geom_kde2d</a></span><span class="op">(</span></span>
<span>    quantiles <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># move the legend under the plot so the</span></span>
<span>  <span class="co"># site names are fully legible</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span></span>
<span>    nrow <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'</span></span></code></pre></div>
<p><img src="KDE2_vignette_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level4">
<h4 id="biplot-with-the-minimum-probability-argument-added-to-show-only-density-regions-above-the-median">Biplot with the minimum probability argument added to show only
density regions above the median<a class="anchor" aria-label="anchor" href="#biplot-with-the-minimum-probability-argument-added-to-show-only-density-regions-above-the-median"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">ArgentinaDatabase</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">`206Pb/204Pb`</span>,</span>
<span>    y <span class="op">=</span> <span class="va">`207Pb/204Pb`</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">`Mining site`</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_kde2d.html">geom_kde2d</a></span><span class="op">(</span></span>
<span>    quantiles <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    min_prob <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># move the legend under the plot so the</span></span>
<span>  <span class="co"># site names are fully legible</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span></span>
<span>    nrow <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'</span></span></code></pre></div>
<p><img src="KDE2_vignette_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level4">
<h4 id="creation-of-an-outline-effect-around-the-density-region">Creation of an outline effect around the density region<a class="anchor" aria-label="anchor" href="#creation-of-an-outline-effect-around-the-density-region"></a>
</h4>
<p>For this effect the fill argument is set to <code>NA</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">ArgentinaDatabase</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">`206Pb/204Pb`</span>,</span>
<span>    y <span class="op">=</span> <span class="va">`207Pb/204Pb`</span>,</span>
<span>    colour <span class="op">=</span> <span class="va">`Mining site`</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_kde2d.html">geom_kde2d</a></span><span class="op">(</span></span>
<span>    quantiles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    min_prob <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># move the legend under the plot so the</span></span>
<span>  <span class="co"># site names are fully legible</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span></span>
<span>    nrow <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'</span></span></code></pre></div>
<p><img src="KDE2_vignette_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level4">
<h4 id="creation-of-an-outline-effect-around-the-density-region-solving-clipping-issues">Creation of an outline effect around the density region solving
clipping issues<a class="anchor" aria-label="anchor" href="#creation-of-an-outline-effect-around-the-density-region-solving-clipping-issues"></a>
</h4>
<p>In some cases density regions can be clipped by the plot area. The
addition of <code><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian()</a></code> from the package
<code>ggplot2</code> expands the plot area so that the full density
regions are shown without clipping. The limits are set for the axes
using the <code>xlim</code> and <code>ylim</code> arguments.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">ArgentinaDatabase</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">`206Pb/204Pb`</span>,</span>
<span>    y <span class="op">=</span> <span class="va">`207Pb/204Pb`</span>,</span>
<span>    colour <span class="op">=</span> <span class="va">`Mining site`</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_kde2d.html">geom_kde2d</a></span><span class="op">(</span></span>
<span>    quantiles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    min_prob <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span></span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17.8</span>, <span class="fl">19</span><span class="op">)</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>    clip <span class="op">=</span> <span class="st">"off"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># move the legend under the plot so the</span></span>
<span>  <span class="co"># site names are fully legible</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span></span>
<span>    nrow <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive</span></span>
<span><span class="co">#&gt; No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x'</span></span>
<span><span class="co">#&gt; No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'</span></span></code></pre></div>
<p><img src="KDE2_vignette_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-DeCeuster2025" class="csl-entry">
De Ceuster, S., Hoogewerff, J., &amp; Degryse, P. (2025). Provenancing
ancient materials with lead isotopes: Overlap uncovered. <em>Scientific
Reports</em>, <em>15</em>(1), 4628. <a href="https://doi.org/10.1038/s41598-025-88909-1" class="external-link">https://doi.org/10.1038/s41598-025-88909-1</a>
</div>
<div id="ref-Duong2007" class="csl-entry">
Duong, T. (2007). Ks: Kernel density estimation and kernel discriminant
analysis for multivariate data in r. <em>Journal of Statistical
Software</em>, <em>21</em>(7), 1–16. <a href="https://doi.org/10.18637/jss.v021.i07" class="external-link">https://doi.org/10.18637/jss.v021.i07</a>
</div>
<div id="ref-Duong2025" class="csl-entry">
Duong, T. (2025). Statistical visualisation of tidy and geospatial data
in r via kernel smoothing methods in the eks package. <em>Computational
Statistics</em>, <em>40</em>(5), 2825–2847. <a href="https://doi.org/10.1007/s00180-024-01543-9" class="external-link">https://doi.org/10.1007/s00180-024-01543-9</a>
</div>
<div id="ref-Hsu2023" class="csl-entry">
Hsu, Y.-K. (2023). <span class="nocase">Visualisation of lead isotope
data</span>. In T. Rose (Ed.), <em><span class="nocase">Lead Isotopes in
Archaeology: an interactive textbook</span></em>. Zenodo. <a href="https://doi.org/10.5281/zenodo.10205820" class="external-link">https://doi.org/10.5281/zenodo.10205820</a>
</div>
<div id="ref-Hsu2018" class="csl-entry">
Hsu, Y.-K., Rawson, J., Pollard, A. M., Ma, Q., Luo, F., Yao, P.-H.,
&amp; Shen, C.-C. (2018). Application of kernel density estimates to
lead isotope compositions of bronzes from ningxia, north-west china.
<em>Archaeometry</em>, <em>60</em>(1), 128–143. <a href="https://doi.org/10.1111/arcm.12347" class="external-link">https://doi.org/10.1111/arcm.12347</a>
</div>
<div id="ref-Pollard2023" class="csl-entry">
Pollard, A. M., Ma, Q., Bidegaray, A.-I., &amp; Liu, R. (2023). The use
of kernel density estimates on chemical and isotopic data in
archaeology. In <em>Handbook of archaeological sciences</em> (pp.
1227–1240). John Wiley &amp; Sons, Ltd. <a href="https://doi.org/10.1002/9781119592112.ch61" class="external-link">https://doi.org/10.1002/9781119592112.ch61</a>
</div>
<div id="ref-Simonoff1996" class="csl-entry">
Simonoff, J. S. (1996). Smoothing methods in statistics. In <em>Springer
Series in Statistics</em>. Springer New York. <a href="https://doi.org/10.1007/978-1-4612-4026-6" class="external-link">https://doi.org/10.1007/978-1-4612-4026-6</a>
</div>
<div id="ref-Weglarczyk2018" class="csl-entry">
Węglarczyk, Stanisław. (2018). Kernel density estimation and its
application. <em>ITM Web Conf.</em>, <em>23</em>, 00037. <a href="https://doi.org/10.1051/itmconf/20182300037" class="external-link">https://doi.org/10.1051/itmconf/20182300037</a>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rose, Andrea Acevedo Mejia, Gilberto Artioli, María Florencia Becerra, Adam Kevin Benfer, Lisa Bellemère, Thomas Edward Birch, Karan Desai, Paolo d’Imporzano, Tzilla Eshel, Valerio Gentile, Sabine Klein, Catherine Klesner, Kathryn Murphy, Ben Marwick, Stephen Merkel, Marco Daniele Pelizzari, Alexandra Rodler, Benjamin Sabatini, Clemens Schmid, Berber van der Meulen-van der Veen, Chen Wang, Katrin Julia Westner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
