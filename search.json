[{"path":"https://archaeothommy.github.io/ASTR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 ASTR authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Binary plot with kernel density estimation","text":"vignette introduces geom_kde2(), generates binary plot kernel density estimation. Kernel density estimation (KDE) non-parametric method transform continuous data smoothed probability density function. According Y.-K. Hsu (2023) Y.-K. Hsu et al. (2018), KDE become popular archaeological science publications (Pollard et al., 2023) mainly due three advantages analysing data: assume normality data; can produce smoother distributions conventional histograms, whose appearance significantly affected choices bin width start/end points bins; can represent data multidimensional space enable users effectively compare different datasets either graphically mathematically (see also De Ceuster et al. (2025) advantages use one-dimensional KDE’s).","code":""},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"what-is-kernel-density-estimation-kde","dir":"Articles","previous_headings":"Introduction","what":"What is Kernel density estimation (KDE)?","title":"Binary plot with kernel density estimation","text":"Kernel density estimation widely-used tool visualising distribution data (Simonoff, 1996). Probability density function (pdf) shows whole 100% probability mass distributed x-axis, .e., values X random variable. Kernel estimation probability density function produces smooth empirical pdf based individual locations sample data. pdf estimate seems better represent “true” pdf continuous variable (Węglarczyk, Stanisław, 2018).","code":""},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"kernel-density-estimation-calculation","dir":"Articles","previous_headings":"Introduction","what":"Kernel density estimation calculation","title":"Binary plot with kernel density estimation","text":"Let series {x1,x2,…,xn}\\{x_1, x_2, \\ldots, x_n\\} independent identically distributed (..d.) sample nn observations taken population XX unknown probability distribution function f(x)f(x). kernel estimate f̂(x)\\hat{f}(x) original f(x)f(x) assigns ii-th sample data point xix_i function K(xi,t)K(x_i, t), called kernel function, following way: f̂(t)=1n∑=1nK(xi,t) \\hat{f}(t) = \\frac{1}{n} \\sum_{=1}^{n} K(x_i, t) \\tag{1} kernel function K(x,t)K(x, t) non-negative bounded xx tt: 0≤K(x,t)<∞real x,t 0 \\leq K(x, t) < \\infty \\quad \\text{real } x, t \\tag{2} , real xx, ∫−∞∞K(x,t)dt=1. \\int_{-\\infty}^{\\infty} K(x, t) \\, dt = 1. \\tag{3} Property (3) ensures required normalisation kernel density estimate given (1): ∫−∞∞f̂(t)dt=1n∑=1n∫−∞∞K(xi,t)dt=1. \\int_{-\\infty}^{\\infty} \\hat{f}(t) \\, dt = \\frac{1}{n} \\sum_{=1}^{n} \\int_{-\\infty}^{\\infty} K(x_i, t) \\, dt = 1. \\tag{4} words, kernel transforms “sharp” (point) location xix_i interval centred (symmetrically ) around xix_i(Węglarczyk, Stanisław, 2018).","code":""},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"function-workflow","dir":"Articles","previous_headings":"Introduction","what":"Function workflow","title":"Binary plot with kernel density estimation","text":"geom_kde2() calculates 2D kernel density estimate using kde() ks package (Duong, 2007, 2025), handling contours manually (compute.cont = FALSE). calculates actual density values (contour levels) corresponding probability levels (probs) using ks::contourLevels(). Using base R function grDevices::contourLines(), contour line coordinates generated, using grid points (eval.points) density estimate (estimate) kde object, calculated levels. contour coordinates converted data frame list items. function extracts coordinates (x, y) assigns unique group ID contour. Specific error messages printed failed density calculations. original data returned added type column checked fallback (values type column equals “points”) determine density estimates failed. data frame plotting points using original x y data fallback data created, applying determined aesthetics drawn using -built GeomPoint draw_panel. Default aesthetic values applied unchanged user.","code":""},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"examples","dir":"Articles","previous_headings":"Introduction","what":"Examples","title":"Binary plot with kernel density estimation","text":"following examples showcase different visualisation density estimate calculations geom_kde2d().","code":""},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"basic-biplot","dir":"Articles","previous_headings":"Introduction > Examples","what":"Basic biplot","title":"Binary plot with kernel density estimation","text":"example reads sample dataset calculates kernel density estimates function geom_kde2d(), colouring Mining site variable dataset. Warning messages appear group sample size small calculate estimates: density estimate possible group 'x', plotting points instead: leading minor order 1 positive. cases, plotting falls back plotting individual points original dataset.","code":"# load example lead isotope data that is included with the package data(ArgentinaDatabase)  library(ggplot2)  ggplot(   ArgentinaDatabase,   aes(     x = `206Pb/204Pb`,     y = `207Pb/204Pb`,     fill = `Mining site`   ) ) +   geom_kde2d() +   theme_minimal() +   # move the legend under the plot so the   # site names are fully legible   theme(     legend.position = \"bottom\",     legend.direction = \"horizontal\"   ) +   guides(fill = guide_legend(     nrow = 10,     theme = theme(legend.byrow = TRUE)   )) #> No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'"},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"biplot-with-adjusted-quantiles-to-show-deciles","dir":"Articles","previous_headings":"Introduction > Examples","what":"Biplot with adjusted quantiles to show deciles","title":"Binary plot with kernel density estimation","text":"default function reverts 4 quantiles. examples illustrates quantiles set 10 show deciles. also sets transparency 0.5 (alpha).","code":"ggplot(   ArgentinaDatabase,   aes(     x = `206Pb/204Pb`,     y = `207Pb/204Pb`,     fill = `Mining site`   ) ) +   geom_kde2d(     quantiles = 10,     alpha = 0.5   ) +   theme_minimal() +   # move the legend under the plot so the   # site names are fully legible   theme(     legend.position = \"bottom\",     legend.direction = \"horizontal\"   ) +   guides(fill = guide_legend(     nrow = 10,     theme = theme(legend.byrow = TRUE)   )) #> No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'"},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"biplot-with-the-minimum-probability-argument-added-to-show-only-density-regions-above-the-median","dir":"Articles","previous_headings":"Introduction > Examples","what":"Biplot with the minimum probability argument added to show only density regions above the median","title":"Binary plot with kernel density estimation","text":"","code":"ggplot(   ArgentinaDatabase,   aes(     x = `206Pb/204Pb`,     y = `207Pb/204Pb`,     fill = `Mining site`   ) ) +   geom_kde2d(     quantiles = 10,     min_prob = 0.5   ) +   theme_minimal() +   # move the legend under the plot so the   # site names are fully legible   theme(     legend.position = \"bottom\",     legend.direction = \"horizontal\"   ) +   guides(fill = guide_legend(     nrow = 10,     theme = theme(legend.byrow = TRUE)   )) #> No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'"},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"creation-of-an-outline-effect-around-the-density-region","dir":"Articles","previous_headings":"Introduction > Examples","what":"Creation of an outline effect around the density region","title":"Binary plot with kernel density estimation","text":"effect fill argument set NA","code":"ggplot(   ArgentinaDatabase,   aes(     x = `206Pb/204Pb`,     y = `207Pb/204Pb`,     colour = `Mining site`   ) ) +   geom_kde2d(     quantiles = 1,     min_prob = 0,     fill = NA   ) +   theme_minimal() +   # move the legend under the plot so the   # site names are fully legible   theme(     legend.position = \"bottom\",     legend.direction = \"horizontal\"   ) +   guides(colour = guide_legend(     nrow = 10,     theme = theme(legend.byrow = TRUE)   )) #> No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'"},{"path":"https://archaeothommy.github.io/ASTR/articles/KDE2_vignette.html","id":"creation-of-an-outline-effect-around-the-density-region-solving-clipping-issues","dir":"Articles","previous_headings":"Introduction > Examples","what":"Creation of an outline effect around the density region solving clipping issues","title":"Binary plot with kernel density estimation","text":"cases density regions can clipped plot area. addition coord_cartesian() package ggplot2 expands plot area full density regions shown without clipping. limits set axes using xlim ylim arguments.","code":"ggplot(   ArgentinaDatabase,   aes(     x = `206Pb/204Pb`,     y = `207Pb/204Pb`,     colour = `Mining site`   ) ) +   geom_kde2d(     quantiles = 1,     min_prob = 0,     fill = NA   ) +   coord_cartesian(     xlim = c(17.8, 19),     ylim = c(15, 16),     clip = \"off\"   ) +   theme_minimal() +   # move the legend under the plot so the   # site names are fully legible   theme(     legend.position = \"bottom\",     legend.direction = \"horizontal\"   ) +   guides(colour = guide_legend(     nrow = 10,     theme = theme(legend.byrow = TRUE)   )) #> No density estimate possible for group '2', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '5', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '12', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '13', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '14', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '16', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '21', plotting points instead: the leading minor of order 2 is not positive #> No density estimate possible for group '23', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '24', plotting points instead: infinite or missing values in 'x' #> No density estimate possible for group '25', plotting points instead: infinite or missing values in 'x'"},{"path":[]},{"path":"https://archaeothommy.github.io/ASTR/articles/VG.ASTR.Conventions.explained.html","id":"units","dir":"Articles","previous_headings":"","what":"Units","title":"Data conventions explained","text":"ASTR accept isotope, element, oxide compositions without explicitly defined units. design choice intentional: units carry essential contextual information determines data can transformed, compared, interpreted. Missing ambiguous units can lead subtle significant errors downstream calculations, inappropriate normalization, invalid aggregations, meaningless statistical analyses.","code":""},{"path":"https://archaeothommy.github.io/ASTR/articles/VG.ASTR.Conventions.explained.html","id":"measurement-uncertainty","dir":"Articles","previous_headings":"","what":"Measurement uncertainty","title":"Data conventions explained","text":"ASTR explicitly handles measurement uncertainty analytical data. Measurement uncertainty parameter encompassing dispersion analytical data random systematically. provides quantitative estimate quality measurement. Random uncertainty: standard deviation (SD) denotes dispersion variability individual data points around mean value statistically normal data set expresses precision individual data within statistical sample. small SD means individual data points close mean value (low variability), whereas high SD means individual data points widely dispersed (high variability). normal distribution, 1 SD covers range approximately 68% data; 2 SD covers range approximately 95% data data set defined. ratio expressed -called 68-95-99.7 rule. Systematic uncertainty: standard error (SE) expresses variability means measurements (statistical samples) relation multiple repetitions (statistical population). hence expresses accuracy measurement. SE becomes smaller sample size increases, since higher repetition measurements provides reliable information true population mean. Confidence intervals used standard deviation. 2-fold standard error (2SD) defines range around calculated mean contains true population mean ca. 95 % probability.","code":""},{"path":"https://archaeothommy.github.io/ASTR/articles/VG.ASTR.Conventions.explained.html","id":"limit-of-detection-and-limit-of-quantification","dir":"Articles","previous_headings":"Measurement uncertainty","what":"Limit of detection and limit of quantification","title":"Data conventions explained","text":"ASTR allows intentional meaningful handling limits detection/quantification. quantitative analysis, threshold can defined, concentration analysed element can longer quantified. dependent various influences, instrument method used (analytical sensitivity), instrumental baseline noise, instrument stability, element measured, matrix effects, measurement conditions including laboratory environment (temperature, humidity), etc. limit detection, usually expressed LOD (indicative notation), defined smallest value can reliably detected. limit quantification (LOQ) defined smallest amount can quantified acceptable precision. archchem(), limit detection indicated detection notation automatically set NA. Users requesting advanced approach valuing LOD ASTR package, e.g. plotting functions, requested implement lambda function redefining bdl_strategy. Substitution methods e.g. dropping left-censored value replacing NA 0, calculating LOD/2 LOD/√2, skipping < left-censored value, using regression models, enhanced censoring calculations, maximum likelihood estimates (Croghan & Egeghy, 2003; Giskeødegård & Lydersen, 2022; Helsel, 2006)","code":""},{"path":[]},{"path":"https://archaeothommy.github.io/ASTR/articles/VG.ASTRschema.0.0.2.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"Data preparation","title":"ASTR schema: Naming conventions","text":"variable names case sensitive. Decimals can read indicated decimal point (0.5), opposed decimal commas (0,5). Apostrophes special characters avoided sample/variable names.","code":""},{"path":"https://archaeothommy.github.io/ASTR/articles/VG.ASTRschema.0.0.2.html","id":"analytical-data-columns-naming","dir":"Articles","previous_headings":"","what":"Analytical Data columns naming","title":"ASTR schema: Naming conventions","text":"columns contain element oxide compositions analytical errors, isotopic values, ratios derived therefrom named using following conventions. Latin characters can supported column names, (.e. δ ε identified). names oxides trace elements self-explanatory (e.g. SiO2 Si). Total iron, given, expressed : FeOtot Fe2O3tot. Loss ignition, known, expressed LOI. Units values follow element oxide, _<unit>. Units supported include SI units, well ppm, ppb, ppt, %, wt%, %, w/w%, ‰, counts, cps, noted . known, specify wt% % instead using %. ‘per mille’, use symbol ‰. isotopic ratios, use simple forms 206Pb/204Pb, 87Sr/86Sr, 147Sm/144Nd, eNd d18O. columns Pb isotope model calculations dataset prior importing data, ensure names contain dash (‘-’) underscore (‘_’) specify columns context read_archem() function. function pb_iso_age_model() can calculate model ages, µ (238U/204Pb), κ (232Th/238U) values using Stacey & Kramers (1975), Cumming & Richards (1975), Albarede & Juteau (1984) systems within ASTR. following notations automatically identified replaced NA, unless explicitly define values read_archem(): ‘NA’, ‘N..’, ‘N/’, ‘na’, ‘n/’, ‘-’, ‘n.d.’. Values containing common excel error messages (#DIV/0!, #VALUE!, #REF!, #NAME?, #NUM!, #N/, #NULL!) also replaced NA automatically. Analytical precision indicated column name : _err2SD, _errSD, _err2SD%, _errSD%, _errSE, _err2SE without indicating unit. unit inferred corresponding composition column. SD, 2SD, SE, 2SE can expressed absolute relative values. strongly recommend uncertainty included data table, properly noted following conventions described.","code":""},{"path":[]},{"path":"https://archaeothommy.github.io/ASTR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Rose Thomas. Maintainer, author. Acevedo Mejia Andrea. Author. Artioli Gilberto. Author. Becerra María Florencia. Author. Benfer Adam Kevin. Author. Bellemère Lisa. Author. Birch Thomas Edward. Author. Desai Karan. Author. d'Imporzano Paolo. Author. Eshel Tzilla. Author. Gentile Valerio. Author. Klein Sabine. Author. Klesner Catherine. Author. Murphy Kathryn. Author. Marwick Ben. Author. Merkel Stephen. Author. Pelizzari Marco Daniele. Author. Rodler Alexandra. Author. Sabatini Benjamin. Author. Schmid Clemens. Author. van der Meulen-van der Veen Berber. Author. Wang Chen. Author. Westner Katrin Julia. Author.","code":""},{"path":"https://archaeothommy.github.io/ASTR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Thomas R, Andrea , Gilberto , María Florencia B, Adam Kevin B, Lisa B, Thomas Edward B, Karan D, Paolo d, Tzilla E, Valerio G, Sabine K, Catherine K, Kathryn M, Ben M, Stephen M, Marco Daniele P, Alexandra R, Benjamin S, Clemens S, Berber v, Chen W, Katrin Julia W (2025). ASTR: Package (One Line, Title Case). R package version 0.0.0.9000, https://example.com.","code":"@Manual{,   title = {ASTR: What the Package Does (One Line, Title Case)},   author = {Rose Thomas and Acevedo Mejia Andrea and Artioli Gilberto and Becerra {María Florencia} and Benfer {Adam Kevin} and Bellemère Lisa and Birch {Thomas Edward} and Desai Karan and d'Imporzano Paolo and Eshel Tzilla and Gentile Valerio and Klein Sabine and Klesner Catherine and Murphy Kathryn and Marwick Ben and Merkel Stephen and Pelizzari {Marco Daniele} and Rodler Alexandra and Sabatini Benjamin and Schmid Clemens and van der Meulen-van der Veen Berber and Wang Chen and Westner {Katrin Julia}},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://example.com}, }"},{"path":"https://archaeothommy.github.io/ASTR/index.html","id":"astr","dir":"","previous_headings":"","what":"ASTR: Archaeological Science Toolbox in R","title":"ASTR: Archaeological Science Toolbox in R","text":"goal ASTR …","code":""},{"path":"https://archaeothommy.github.io/ASTR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"ASTR: Archaeological Science Toolbox in R","text":"can install development version ASTR GitHub :","code":"# install.packages(\"pak\") #pak::pak(\"archaeothommy/ASTR\")"},{"path":"https://archaeothommy.github.io/ASTR/reference/ASTR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ASTR: What the Package Does (One Line, Title Case) — ASTR-package","title":"ASTR: What the Package Does (One Line, Title Case) — ASTR-package","text":"package (one paragraph).","code":""},{"path":[]},{"path":"https://archaeothommy.github.io/ASTR/reference/ASTR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ASTR: What the Package Does (One Line, Title Case) — ASTR-package","text":"Maintainer: Rose Thomas roseth@posteo.com (ORCID) Authors: Acevedo Mejia Andrea (ORCID) Artioli Gilberto (ORCID) Becerra María Florencia (ORCID) Benfer Adam Kevin (ORCID) Bellemère Lisa Birch Thomas Edward (ORCID) Desai Karan (ORCID) d'Imporzano Paolo Eshel Tzilla (ORCID) Gentile Valerio (ORCID) Klein Sabine (ORCID) Klesner Catherine (ORCID) Murphy Kathryn (ORCID) Marwick Ben (ORCID) Merkel Stephen (ORCID) Pelizzari Marco Daniele Rodler Alexandra (ORCID) Sabatini Benjamin (ORCID) Schmid Clemens (ORCID) van der Meulen-van der Veen Berber (ORCID) Wang Chen (ORCID) Westner Katrin Julia (ORCID)","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/ArgentinaDatabase.html","id":null,"dir":"Reference","previous_headings":"","what":"ArgentinaDatabase — ArgentinaDatabase","title":"ArgentinaDatabase — ArgentinaDatabase","text":"Lead isotope data ore deposits Argentina prepared TerraLID database.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/ArgentinaDatabase.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ArgentinaDatabase — ArgentinaDatabase","text":"","code":"ArgentinaDatabase"},{"path":[]},{"path":"https://archaeothommy.github.io/ASTR/reference/ArgentinaDatabase.html","id":"argentinadatabase","dir":"Reference","previous_headings":"","what":"ArgentinaDatabase","title":"ArgentinaDatabase — ArgentinaDatabase","text":"dataframe 112 rows 49 columns","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/ArgentinaDatabase.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"ArgentinaDatabase — ArgentinaDatabase","text":"https://globalid.dmt-lb.de/","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/age_models.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate lead isotope age models — age_models","title":"Calculate lead isotope age models — age_models","text":"functions calculate age model respective mu kappa values according publications named (see References). pb_iso_age_model() provides wrapper allows calculate age models simultaneously.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/age_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate lead isotope age models — age_models","text":"","code":"pb_iso_age_model(   df,   ratio_206_204 = \"206Pb/204Pb\",   ratio_207_204 = \"207Pb/204Pb\",   ratio_208_204 = \"208Pb/204Pb\",   model = c(\"SK75\", \"CR75\", \"AJ84\", \"all\") )  stacey_kramers_1975(   df,   ratio_206_204 = \"206Pb/204Pb\",   ratio_207_204 = \"207Pb/204Pb\",   ratio_208_204 = \"208Pb/204Pb\" )  cumming_richards_1975(   df,   ratio_206_204 = \"206Pb/204Pb\",   ratio_207_204 = \"207Pb/204Pb\",   ratio_208_204 = NULL )  albarede_juteau_1984(   df,   ratio_206_204 = \"206Pb/204Pb\",   ratio_207_204 = \"207Pb/204Pb\",   ratio_208_204 = \"208Pb/204Pb\" )"},{"path":"https://archaeothommy.github.io/ASTR/reference/age_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate lead isotope age models — age_models","text":"df data frame age model calculated. ratio_206_204 Name column 206Pb/204Pb ratio character string. Default 206Pb/204Pb. ratio_207_204 Name column 207Pb/204Pb ratio character string. Default 207Pb/204Pb. ratio_208_204 Name column 208Pb/204Pb ratio character string. Default 208Pb/204Pb. model Character string abbreviation model calculate: SK75 Stacey & Kramers (1975) CR75 Cumming & Richards (1975) AJ84 Albarède & Juteau (1984) models ","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/age_models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate lead isotope age models — age_models","text":"data frame provided input columns added model age, mu, kappa value(s) respective age models. used model indicated column names output abbreviations given .","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/age_models.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate lead isotope age models — age_models","text":"implemented age models : Stacey & Kramers (1975): stacey_kramers_1975() Cumming & Richards (1975): cumming_richards_1975() Albarède & Juteau (1984): albarede_juteau_1984() used model indicated column names output initials author's last names publication year (e. g.SK75 Stacey & Kramers 1975). See references respective publications age models. function age model Albarède & Juteau (1984) based MATLAB-script F. Albarède (version 2020-11-06). age model published Albarède et al. (2012) used according F. Albarède therefore implemented. Instead, recommends use age model published Albarède & Juteau (1984). ratio 208Pb/204Pb necessary cumming_richards_1975. function takes argument consistent input age model functions. provided, ignored.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/age_models.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate lead isotope age models — age_models","text":"Albarède, F. Juteau, M. (1984) Unscrambling lead model ages. Geochimica et Cosmochimica Acta 48(1), pp. 207–212. https://dx.doi.org/10.1016/0016-7037(84)90364-8. Albarède, F., Desaulty, .-M. Blichert-Toft, J. (2012) geological perspective use Pb isotopes Archaeometry. Archaeometry 54, pp. 853–867. https://doi.org/10.1111/j.1475-4754.2011.00653.x. Cumming, G.L. Richards, J.R. (1975) Ore lead isotope ratios continuously changing earth. Earth Planetary Science Letters 28(2), pp. 155–171. https://dx.doi.org/10.1016/0012-821X(75)90223-X. Stacey, J.S. Kramers, J.D. (1975) Approximation terrestrial lead isotope evolution two-stage model. Earth Planetary Science Letters 26(2), pp. 207–221. <https://dx.doi.org/10.1016/0012-821X(75)90088-6<.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/age_models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate lead isotope age models — age_models","text":"","code":"# creating example data df <- tibble::tibble(   `206Pb/204Pb` = runif(5, min = 18, max = 18.5),   `207Pb/204Pb` = runif(5, min = 15, max = 15.5),   `208Pb/204Pb` = runif(5, min = 2, max = 2.2) )  # calculate values for all age models pb_iso_age_model(df, model = \"all\") #>   206Pb/204Pb 207Pb/204Pb 208Pb/204Pb model_age_SK75 mu_SK75 kappa_SK75 #> 1    18.30038    15.14488    2.006848       -963.871   7.820    -15.103 #> 2    18.07860    15.36644    2.064077       -109.337   8.745    -16.169 #> 3    18.00370    15.38626    2.080466          2.782   8.843    -16.421 #> 4    18.23320    15.43730    2.039134        -65.723   9.016    -15.861 #> 5    18.24889    15.08747    2.080708      -1112.699   7.600    -15.074 #>   model_age_CR75 mu_CR75 kappa_CR75 model_age_AJ84 mu_AJ84 kappa_AJ84 #> 1        326.633  10.575      3.854       -811.770   7.932    -14.881 #> 2        447.135  10.510      3.860        -30.577   8.772    -15.869 #> 3        489.280  10.488      3.862         76.023   8.862    -16.108 #> 4        355.354  10.559      3.855         -0.593   9.015    -15.565 #> 5        358.829  10.558      3.855       -937.725   7.732    -14.866  # calculate values for a specific age model pb_iso_age_model(df, model = \"SK75\") #>   206Pb/204Pb 207Pb/204Pb 208Pb/204Pb model_age_SK75 mu_SK75 kappa_SK75 #> 1    18.30038    15.14488    2.006848       -963.871   7.820    -15.103 #> 2    18.07860    15.36644    2.064077       -109.337   8.745    -16.169 #> 3    18.00370    15.38626    2.080466          2.782   8.843    -16.421 #> 4    18.23320    15.43730    2.039134        -65.723   9.016    -15.861 #> 5    18.24889    15.08747    2.080708      -1112.699   7.600    -15.074 stacey_kramers_1975(df) #>   206Pb/204Pb 207Pb/204Pb 208Pb/204Pb model_age_SK75 mu_SK75 kappa_SK75 #> 1    18.30038    15.14488    2.006848       -963.871   7.820    -15.103 #> 2    18.07860    15.36644    2.064077       -109.337   8.745    -16.169 #> 3    18.00370    15.38626    2.080466          2.782   8.843    -16.421 #> 4    18.23320    15.43730    2.039134        -65.723   9.016    -15.861 #> 5    18.24889    15.08747    2.080708      -1112.699   7.600    -15.074"},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem.html","id":null,"dir":"Reference","previous_headings":"","what":"archchem — archchem","title":"archchem — archchem","text":"tabular data format chemical analysis datasets archaeology, including contextual information, numerical elemental, isotopic data. Columns assigned units (using set_units) categories (attribute archchem_class) based column name. following functions allow create objects class archchem, interact . as_archchem: Transforms R data.frame object class archchem. read_archchem: Reads data file (.csv, .xls, .xlsx) object class archchem. validate: Performs additional validation archchem returns data.frame workable list potential issues. get_..._columns: Subsets archchem tables columns certain category (archchem_class), e.g. contextual data columns. remove_units: Removes unit vector types analytical columns archchem table replaces simple numeric columns type double. unify_concentration_unit: Unifies unit concentration column, e.g. either % ppm (SI unit) avoid mixing units derived analyses. archchem derived tibble directly compatible data manipulation tools tidyverse.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"archchem — archchem","text":"","code":"as_archchem(   df,   id_column = \"ID\",   context = c(),   bdl = c(\"b.d.\", \"bd\", \"b.d.l.\", \"bdl\", \"<LOD\", \"<\"),   bdl_strategy = function() NA_character_,   guess_context_type = TRUE,   na = c(\"\", \"n/a\", \"NA\", \"N.A.\", \"N/A\", \"na\", \"-\", \"n.d.\", \"n.a.\", \"#DIV/0!\", \"#VALUE!\",     \"#REF!\", \"#NAME?\", \"#NUM!\", \"#N/A\", \"#NULL!\"),   drop_columns = FALSE,   validate = TRUE,   ... )  validate(x, quiet = TRUE, ...)  read_archchem(   path,   id_column = \"ID\",   context = c(),   delim = \",\",   guess_context_type = TRUE,   na = c(\"\", \"n/a\", \"NA\", \"N.A.\", \"N/A\", \"na\", \"-\", \"n.d.\", \"n.a.\", \"#DIV/0!\", \"#VALUE!\",     \"#REF!\", \"#NAME?\", \"#NUM!\", \"#N/A\", \"#NULL!\"),   bdl = c(\"b.d.\", \"bd\", \"b.d.l.\", \"bdl\", \"<LOD\", \"<\"),   bdl_strategy = function() NA_character_,   drop_columns = FALSE,   validate = TRUE,   ... )  validate(x, quiet = TRUE, ...)  # S3 method for class 'archchem' format(x, ...)  # S3 method for class 'archchem' print(x, ...)  get_contextual_columns(x, ...)  get_analytical_columns(x, ...)  get_isotope_columns(x, ...)  get_element_columns(x, ...)  get_ratio_columns(x, ...)  get_concentration_columns(x, ...)  remove_units(x, ...)  unify_concentration_unit(x, unit, ...)"},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"archchem — archchem","text":"df data.frame containing input table id_column name ID column. Defaults \"ID\" context columns provide contextual (non-measurement) information; may column names, integer positions, logical inclusion vector bdl strings representing “detection limit” values. default, following recognized: \"b.d.\", \"bd\", \"b.d.l.\", \"bdl\", \"<LOD\", \"<\" bdl_strategy function used replace BDL strings. Defaults static function returning NA guess_context_type appropriate data types contextual columns guessed automatically? Defaults TRUE na character vector strings interpret missing values. default, following recognized: \"\", \"n/\", \"NA\", \"N..\", \"N/\", \"na\", \"-\", \"n.d.\", \"n..\", \"#DIV/0!\", \"#VALUE!\", \"#REF!\", \"#NAME?\", \"#NUM!\", \"#N/\", \"#NULL!\" drop_columns columns neither marked contextual context, automatically identified analytical column name, dropped proceed reading? Defaults FALSE validate post-reading input validation run, checks additional properties archchem tables. Defaults TRUE ... Additional arguments passed respective import functions. See documentation details: readxl::read_excel() file formats .xlsx .xls readr::read_delim() file formats. x object class archchem quiet warnings printed? Defaults TRUE path path file read delim character string separator tabular data. Must provided file types except .xlsx .xls. Default ,. Use \\t tab-separated data. unit string unit definition can understood set_units, e.g. \"%\", \"kg\", \"m/s^2\"","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"archchem — archchem","text":"Returns object class archchem, tibble-derived object.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"archchem — archchem","text":"input data files can fairly freeform, .e. specified elements, oxides, isotopic ratios required exact order needs adhered . Analyses can contain many analytical columns necessary. column contains unique samples identifier must specified using ID argument. dataset contains duplicate ids renamed consecutively using following convention: _1,_2, ... _n. Metadata contained within dataset must marked using context argument. column dataframe specified context recognised analytical column, result error. detection limit notation (.e. ‘b.d.’, ‘bd’, ‘b.d.l.’, ‘bdl’, ‘<LOD’, ‘<..’) element oxide concentrations specified using bdl argument. One notations can used appropriate dataset, can notations included list . argument bdl_strategy used specify value handling detection limits. facilitate different handling needs detection limit future statistical applications, opposed automatically assigning values ‘NA’. Missing values allowed anywhere data file body, replaced NA automatically.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"archchem — archchem","text":"","code":"library(magrittr)  # reading an archchem table directly from a file test_file <- system.file(\"extdata\", \"test_data_input_good.csv\", package = \"ASTR\") arch <- read_archchem(test_file, id_column = \"Sample\", context = 1:7) #> Warning: 39 missing values across 12 analytical columns #> Warning: See the full list of validation output with: ASTR::validate(<your archchem object>).  # turning a data.frame to an archchem table test_df <- readr::read_csv(test_file) #> Rows: 14 Columns: 53 #> ── Column specification ──────────────────────────────────────────────────────── #> Delimiter: \",\" #> chr (12): Sample, Lab no., Site, method_comp, P2O5_wt%, As_wt%, LOI_wt%, Te_... #> dbl (41): latitude, longitude, Type, 143Nd/144Nd, d65Cu, d65Cu_err2SD, Na2O_... #>  #> ℹ Use `spec()` to retrieve the full column specification for this data. #> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. arch <- as_archchem(test_df, id_column = \"Sample\", context = 1:7) #> Warning: Issue when transforming column \"P2O5_wt%\" to numeric values: NAs introduced by coercion #> Warning: Issue when transforming column \"LOI_wt%\" to numeric values: NAs introduced by coercion #> Warning: Issue when transforming column \"U_ppm\" to numeric values: NAs introduced by coercion #> Warning: Issue when transforming column \"Co_ppm\" to numeric values: NAs introduced by coercion #> Warning: Issue when transforming column \"Se_ppm\" to numeric values: NAs introduced by coercion #> Warning: 39 missing values across 12 analytical columns #> Warning: See the full list of validation output with: ASTR::validate(<your archchem object>).  # validating an archchem table validate(arch) #> # A tibble: 12 × 3 #>    column      count warning        #>    <chr>       <int> <chr>          #>  1 143Nd/144Nd     7 missing values #>  2 P2O5_wt%        1 missing values #>  3 S_at%           1 missing values #>  4 CaO_wt%         1 missing values #>  5 TiO2_wt%        3 missing values #>  6 As_wt%          1 missing values #>  7 LOI_wt%         5 missing values #>  8 Te_ppm          2 missing values #>  9 Bi_ppm          2 missing values #> 10 U_ppm           4 missing values #> 11 Co_ppm          2 missing values #> 12 Se_ppm         10 missing values  # extracting subsets of columns conc <- get_concentration_columns(arch) # see also other get_..._columns functions  # unit-aware arithmetics on archchem columns thanks to the units package conc$Sb_ppm + conc$Ag_ppb # works #> Units: [ppm] #>  [1]  370.50  210.20  256.21  400.35  410.40  453.25  701.12  231.43  107.30 #> [10] 3312.42   95.14   79.61  610.10  390.10 #> attr(,\"archchem_class\") #> [1] \"archchem_concentration\" if (FALSE) conc$Sb_ppm + conc$`Sn_µg/ml` # \\dontrun{} # fails with: cannot convert µg/ml into ppm  # converting units conc$Sb_ppb <- units::set_units(arch$Sb_ppm, \"ppb\") %>%   magrittr::set_attr(\"archchem_class\", \"archchem_concentration\")  # removing all units from archchem tables remove_units(arch) #> archchem table #> Analytical columns: 143Nd/144Nd, d65Cu, d65Cu_err2SD, Na2O_wt%, BaO_wt%, Pb_wt%, MgO_wt%, Al2O3_wt%, SiO2_wt%, SiO2_errSD%, P2O5_wt%, S_at%, CaO_wt%, TiO2_wt%, MnO_wt%, FeOtot_wt%, FeOtot_err2SD, ZnO_%, K2O_wt%, Cu_wt%, As_wt%, LOI_wt%, Ag_ppb, Sn_µg/ml, Sb_ppm, Te_ppm, Bi_ppm, U_ppm, V_ppm, Cr_ppm, Co_ppm, Ni_ppm, Sr_ppm, Se_ppm, FeOtot/SiO2, (Na2O+K2O)/SiO2, 206Pb/204Pb, 206Pb/204Pb_err2SD, 207Pb/204Pb, 207Pb/204Pb_err2SD, 208Pb/204Pb, 208Pb/204Pb_err2SD, 207Pb/206Pb, 207Pb/206Pb_err2SD, 208Pb/206Pb, 208Pb/206Pb_err2SD #> Contextual columns: Sample, Lab no., Site, latitude, longitude, Type, method_comp  #> # A data frame: 14 × 54 #>    ID       Sample   `Lab no.` Site         latitude longitude  Type method_comp #>    <chr>    <chr>    <chr>     <chr>           <dbl>     <dbl> <dbl> <chr>       #>  1 TR-001   TR-001   3421/19   Bochum           51.5      7.22     1 ICP-MS      #>  2 TR-002_1 TR-002_1 3423/19   Oviedo           43.4     -5.84     2 ICP-MS      #>  3 TR-002_2 TR-002_2 3435/19   Oviedo           43.4     -5.84     2 ICP-MS      #>  4 TR-003   TR-003   3422/19   佛山             23.0    113.       3 ICP-MS      #>  5 TR-004   TR-004   3429/19   Băiuț            43.2     23.1      4 ICP-MS      #>  6 TR-005   TR-005   3430/19   Şuior            41.4     24.9      5 ICP-MS      #>  7 TR-006.1 TR-006.1 3431/19   Blagodat         41.5     25.5      5 ICP-MS      #>  8 TR-006.2 TR-006.2 3432/19   Pezinok          45.9     15.9      1 ICP-MS      #>  9 TR-006.3 TR-006.3 3433/19   Free State …     50.4      7.65     4 ICP-MS      #> 10 smn348   smn348   3424/19   Aggenys          51.0      8.03     3 ICP-MS      #> 11 smn349   smn349   3425/19   Chiprovtsi       50.7      6.41     3 ICP-MS      #> 12 smn350   smn350   3426/19   Krusov Dol;…     40.7     24.6      5 ICP-MS      #> 13 smn351   smn351   3427/19   Masua            37.7     24.0      1 ICP-MS      #> 14 8896     8896     3428/19   Σπαρτη           37.1     22.4      1 ICP-MS      #> # ℹ 46 more variables: `143Nd/144Nd` <dbl>, d65Cu <dbl>, d65Cu_err2SD <dbl>, #> #   `Na2O_wt%` <dbl>, `BaO_wt%` <dbl>, `Pb_wt%` <dbl>, `MgO_wt%` <dbl>, #> #   `Al2O3_wt%` <dbl>, `SiO2_wt%` <dbl>, `SiO2_errSD%` <dbl>, `P2O5_wt%` <dbl>, #> #   `S_at%` <dbl>, `CaO_wt%` <dbl>, `TiO2_wt%` <dbl>, `MnO_wt%` <dbl>, #> #   `FeOtot_wt%` <dbl>, FeOtot_err2SD <dbl>, `ZnO_%` <dbl>, `K2O_wt%` <dbl>, #> #   `Cu_wt%` <dbl>, `As_wt%` <dbl>, `LOI_wt%` <dbl>, Ag_ppb <dbl>, #> #   `Sn_µg/ml` <dbl>, Sb_ppm <dbl>, Te_ppm <dbl>, Bi_ppm <dbl>, U_ppm <dbl>, …  # applying tidyverse data manipulation on archchem tables arch %>%   dplyr::group_by(Site) %>%   dplyr::summarise(mean_Na2O = mean(`Na2O_wt%`)) #> # A tibble: 13 × 2 #>    Site                    mean_Na2O #>    <chr>                         [%] #>  1 Aggenys                       4.1 #>  2 Blagodat                      3.4 #>  3 Bochum                        3.1 #>  4 Băiuț                         3   #>  5 Chiprovtsi                    3.4 #>  6 Free State Geduld Mines       5.1 #>  7 Krusov Dol; Krushev Dol       4.5 #>  8 Masua                         3.2 #>  9 Oviedo                        3.6 #> 10 Pezinok                       1.8 #> 11 Şuior                         4.1 #> 12 Σπαρτη                        3.7 #> 13 佛山                          6.9 conc_subset <- conc %>%   dplyr::select(-`Sn_µg/ml`, -`Sb_ppm`) %>%   dplyr::filter(`Na2O_wt%` > units::set_units(1, \"%\"))  # unify all concentration units unify_concentration_unit(conc_subset, \"ppm\") #> archchem table #> Analytical columns: Na2O_wt%, BaO_wt%, Pb_wt%, MgO_wt%, Al2O3_wt%, SiO2_wt%, P2O5_wt%, S_at%, CaO_wt%, TiO2_wt%, MnO_wt%, FeOtot_wt%, ZnO_%, K2O_wt%, Cu_wt%, As_wt%, LOI_wt%, Ag_ppb, Te_ppm, Bi_ppm, U_ppm, V_ppm, Cr_ppm, Co_ppm, Ni_ppm, Sr_ppm, Se_ppm, Sb_ppb  #> # A data frame: 14 × 29 #>    ID       `Na2O_wt%` `BaO_wt%` `Pb_wt%` `MgO_wt%` `Al2O3_wt%` `SiO2_wt%` #>    <chr>         [ppm]     [ppm]    [ppm]     [ppm]       [ppm]      [ppm] #>  1 TR-001        31000       700    63400      7700       39200     316300 #>  2 TR-002_1      22000       700    35200      5500       34600     290600 #>  3 TR-002_2      50000       540    36000      3300       58700     305000 #>  4 TR-003        69000       400    50700      7600       43300     257300 #>  5 TR-004        30000       300    91500      5200       41700     435000 #>  6 TR-005        41000       700   126100      5800       35800     338300 #>  7 TR-006.1      34000       500   126800      6400       56000     338100 #>  8 TR-006.2      18000       400    53100      5900       44700     263900 #>  9 TR-006.3      51000       900    23600      5300       37300     211800 #> 10 smn348        41000      3400   474900      7000       62700     317300 #> 11 smn349        34000       400    25300      4600       29100     169100 #> 12 smn350        45000       700    15600      5800       36000     284900 #> 13 smn351        32000       400    36400      8800       52400     380400 #> 14 8896          37000       600    75100      8400       39700     316700 #> # ℹ 22 more variables: `P2O5_wt%` [ppm], `S_at%` [ppm], `CaO_wt%` [ppm], #> #   `TiO2_wt%` [ppm], `MnO_wt%` [ppm], `FeOtot_wt%` [ppm], `ZnO_%` [ppm], #> #   `K2O_wt%` [ppm], `Cu_wt%` [ppm], `As_wt%` [ppm], `LOI_wt%` [ppm], #> #   Ag_ppb [ppm], Te_ppm [ppm], Bi_ppm [ppm], U_ppm [ppm], V_ppm [ppm], #> #   Cr_ppm [ppm], Co_ppm [ppm], Ni_ppm [ppm], Sr_ppm [ppm], Se_ppm [ppm], #> #   Sb_ppb [ppm] # note that the column names are inaccurate now"},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem_example_input.html","id":null,"dir":"Reference","previous_headings":"","what":"archchem_example_input — archchem_example_input","title":"archchem_example_input — archchem_example_input","text":"dataset contains fictitious data mimicking lead slags including composition, isotopic, contextual information. variable names conform ASTR conventions (see \"ASTR Schema\" vignette).","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem_example_input.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"archchem_example_input — archchem_example_input","text":"","code":"data(archchem_example_input)"},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem_example_input.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"archchem_example_input — archchem_example_input","text":"data frame 15 observations 53 variables.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/archchem_example_input.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"archchem_example_input — archchem_example_input","text":"Sample. Individual samples compositional isotopic data, contextual information provided dataset. Lab., Site, latitude, longitude, Type, method_comp. Columns containing contextual information samples. 143Nd/144Nd, d65Cu, d65Cu_err2SD, 206Pb/204Pb, 206Pb/204Pb_err2SD, 207Pb/204Pb, 207Pb/204Pb_err2SD, 208Pb/204Pb, 208Pb/204Pb_err2SD,207Pb/206Pb, 207Pb/206Pb_err2SD,208Pb/206Pb, 208Pb/206Pb_err2SD. Columns containing isotopic data. Na2O_wt%, BaO_wt%, Pb_wt%, MgO_wt%, Al2O3_wt%, SiO2_wt%, SiO2_errSD%, P2O5_wt%, S_at%, CaO_wt%,TiO2_wt%, MnO_wt%, FeOtot_wt%, FeOtot_err2SD, ZnO%, K2O_wt%, Cu_wt%, As_wt%, LOI_wt%, Ag_ppb, Sn_µg/ml, Sb_ppm, Te_ppm, Bi_ppm, U_ppm, V_ppm, Cr_ppm, Co_ppm, Ni_ppm, Sr_ppm, Se_ppm, FeOtot/SiO2, (Na2O+K2O)/SiO2. Columns containing compositional data.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/elements.html","id":null,"dir":"Reference","previous_headings":"","what":"Elements — elements","title":"Elements — elements","text":"List elements, sorted according alphabet","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/elements.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Elements — elements","text":"","code":"elements"},{"path":"https://archaeothommy.github.io/ASTR/reference/elements.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Elements — elements","text":"vector","code":""},{"path":[]},{"path":"https://archaeothommy.github.io/ASTR/reference/geom_kde2d.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw 2D Kernel Density Estimate Polygons by Quantiles — geom_kde2d","title":"Draw 2D Kernel Density Estimate Polygons by Quantiles — geom_kde2d","text":"geom creates polygons based 2D kernel density estimate, calculated using ks::kde() function. serves alternative ggplot2::geom_density_2d(), displaying results filled polygons corresponding specified quantiles. density estimation fails group (e.g., due unique points), geom gracefully fall back plotting raw data points group, inheriting aesthetics ggplot2::geom_point().","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/geom_kde2d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw 2D Kernel Density Estimate Polygons by Quantiles — geom_kde2d","text":"","code":"geom_kde2d(   mapping = NULL,   data = NULL,   inherit.aes = TRUE,   quantiles = 4,   min_prob = 0.02,   show.legend = NA,   fallback_to_points = TRUE,   ... )"},{"path":"https://archaeothommy.github.io/ASTR/reference/geom_kde2d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw 2D Kernel Density Estimate Polygons by Quantiles — geom_kde2d","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders(). quantiles Integer. number quantiles display. example, quantiles = 4 (default) draw quartiles. min_prob numeric value [0, 1]. Sets lowest probability quantile drawn. default, 0.02, helps avoid creating polygons around single outlier points. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. fallback_to_points Logical. prevent points drawn groups fail density estimation, set FALSE. example, want control point aesthetics, independent KDE regions, set FALSE use geom_point plot points ... arguments passed ggplot2::layer(). often aesthetics used set fixed value, colour = \"red\" alpha = 0.5.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/geom_kde2d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw 2D Kernel Density Estimate Polygons by Quantiles — geom_kde2d","text":"ggplot2 layer object.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/geom_kde2d.html","id":"aesthetics","dir":"Reference","previous_headings":"","what":"Aesthetics","title":"Draw 2D Kernel Density Estimate Polygons by Quantiles — geom_kde2d","text":"geom_kde2d() understands following aesthetics (required aesthetics bold): x y group alpha colour (controls polygon outline) fill (controls polygon fill) linetype linewidth (controls outline thickness) size (controls point size) shape (used fallback points) Learn setting aesthetics vignette(\"ggplot2-specs\").","code":""},{"path":[]},{"path":"https://archaeothommy.github.io/ASTR/reference/geom_kde2d.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw 2D Kernel Density Estimate Polygons by Quantiles — geom_kde2d","text":"","code":"library(ggplot2)  # Basic usage with iris data ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, fill = Species)) +   geom_kde2d()   # Adjusting quantiles to show deciles ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, fill = Species)) +   geom_kde2d(quantiles = 10, alpha = 0.5)   # Using min_prob to show only density regions above the median ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, fill = Species)) +   geom_kde2d(quantiles = 10, min_prob = 0.5)   # Creating an outline effect ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +   geom_kde2d(quantiles = 1, min_prob = 0, fill = NA)   # Creating an outline effect, and using coord_cartesian to expand the # plot area so the full KDE regions show without clipping ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +   geom_kde2d(quantiles = 1, min_prob = 0, fill = NA) +   coord_cartesian(xlim = c(4, 8.2), ylim = c(2, 4.5), clip = \"off\")   # Example of fallback behavior # Create a dataset where one group has too few points for density estimation set.seed(123) df <- data.frame(   x = c(rnorm(50), rnorm(50, 5), rnorm(2, 10)),   y = c(rnorm(50), rnorm(50, 5), rnorm(2, 10)),   group = rep(c(\"A\", \"B\", \"C\"), c(50, 50, 2)) )  # A message will indicate that group \"C\" is plotted as points ggplot(df, aes(x, y, fill = group, colour = group)) +   geom_kde2d(alpha = 0.4) +   theme_minimal() #> No density estimate possible for group '3', plotting points instead: the leading minor of order 2 is not positive"},{"path":"https://archaeothommy.github.io/ASTR/reference/isotopes.html","id":null,"dir":"Reference","previous_headings":"","what":"Isotopes — isotopes","title":"Isotopes — isotopes","text":"List naturally occurring isotopes, retrieved https://www.ciaaw.org/isotopic-abundances.htm, sorted according chemical element isotope number","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/isotopes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Isotopes — isotopes","text":"","code":"isotopes"},{"path":"https://archaeothommy.github.io/ASTR/reference/isotopes.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Isotopes — isotopes","text":"vector","code":""},{"path":[]},{"path":"https://archaeothommy.github.io/ASTR/reference/oxides.html","id":null,"dir":"Reference","previous_headings":"","what":"Oxides — oxides","title":"Oxides — oxides","text":"List oxides, retrieved https://www.wikidoc.org/index.php/Oxide, sorted according alphabet","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/oxides.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Oxides — oxides","text":"","code":"oxides"},{"path":"https://archaeothommy.github.io/ASTR/reference/oxides.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Oxides — oxides","text":"vector","code":""},{"path":[]},{"path":"https://archaeothommy.github.io/ASTR/reference/pointcloud_distribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Comparing Isotope Samples to Reference Data in 3D Space — pointcloud_distribution","title":"Comparing Isotope Samples to Reference Data in 3D Space — pointcloud_distribution","text":"package compares isotope samples reference data 3D space identify isotopic consistency possibility mixing sources.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/pointcloud_distribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Comparing Isotope Samples to Reference Data in 3D Space — pointcloud_distribution","text":"","code":"pointcloud_distribution(   df,   ref,   isotope_sample = c(\"206Pb/204Pb\", \"207Pb/204Pb\", \"208Pb/204Pb\"),   isotope_ref = isotope_sample,   id_sample = \"ID\",   id_ref = id_sample )"},{"path":"https://archaeothommy.github.io/ASTR/reference/pointcloud_distribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Comparing Isotope Samples to Reference Data in 3D Space — pointcloud_distribution","text":"df Data frame sample data, including isotope ratios ID columns. ref Data frame reference data, including isotope ratios group column. isotope_sample, isotope_ref Character vectors column names isotope ratios. Default c(\"206Pb/204Pb\", \"207Pb/204Pb\", \"208Pb/204Pb\"). id_sample, id_ref String column name sample IDs identifier reference groups. Default ID.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/pointcloud_distribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Comparing Isotope Samples to Reference Data in 3D Space — pointcloud_distribution","text":"list three elements: in_hull: logical. Boolean value indicating inclusion sample data within convex hull reference data. centroids: data.frame. coordinates centroids (mean values) defined reference group. distances: matrix. distance matrix rows represent samples columns represent reference centroids, containing distance sample centroid.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/pointcloud_distribution.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Comparing Isotope Samples to Reference Data in 3D Space — pointcloud_distribution","text":"Calculates convex hull complete set reference points specified subgroups. determines inclusion exclusion sample isotope values within hulls. function also calculates: centroid reference subgroup mean value points within vertex group. distance sample point every subgroup's centroid. Interpretation: Inclusion within hull suggests sample part mixing group (main hull) highly likely specific end member (subgroup hull). distance calculation provides measure proximity end member centers.","code":""},{"path":"https://archaeothommy.github.io/ASTR/reference/pointcloud_distribution.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Comparing Isotope Samples to Reference Data in 3D Space — pointcloud_distribution","text":"","code":"# Create synthetic data set.seed(24021999) iso <- c(\"206Pb/204Pb\",\"207Pb/204Pb\",\"208Pb/204Pb\")  # Create synthetic reference data groups <- LETTERS[1:4] rand_iso <- function(){c(runif(1, 18.3, 19), runif(1, 15.5, 15.9), runif(1, 37.5, 39))} list_df <- lapply(groups, function(x){   ls <- sapply(rand_iso(),  function(g){stats::rnorm(20, g, stats::runif(1, 0.05, 0.1))})   colnames(ls) <- iso   ls <- as.data.frame(ls)   ls$ID <- x   ls }) ref <- as.data.frame(do.call(rbind, list_df))  ## Create sample data df <- as.data.frame(sapply(rand_iso(),  function(g){rnorm(20, g, 0.1)})) colnames(df) <- iso df$ID <- letters[1:20] rm(list_df, iso, groups, rand_iso)  # Run pointcloud_distribution pointcloud_distribution(df, ref, isotope_sample = c(\"206Pb/204Pb\", \"207Pb/204Pb\", \"208Pb/204Pb\"), id_sample = \"ID\") #> $in_hull #>   hull_inout     A     B     C     D #> a      FALSE FALSE FALSE FALSE FALSE #> b       TRUE FALSE FALSE FALSE FALSE #> c       TRUE FALSE FALSE FALSE  TRUE #> d       TRUE FALSE FALSE FALSE FALSE #> e      FALSE FALSE FALSE FALSE FALSE #> f      FALSE FALSE FALSE FALSE FALSE #> g       TRUE FALSE FALSE FALSE FALSE #> h       TRUE FALSE FALSE FALSE FALSE #> i       TRUE FALSE FALSE FALSE  TRUE #> j      FALSE FALSE FALSE FALSE FALSE #> k       TRUE FALSE FALSE FALSE FALSE #> l       TRUE FALSE FALSE FALSE FALSE #> m       TRUE FALSE FALSE FALSE FALSE #> n       TRUE FALSE FALSE FALSE FALSE #> o       TRUE FALSE FALSE FALSE FALSE #> p       TRUE FALSE FALSE FALSE FALSE #> q      FALSE FALSE FALSE FALSE FALSE #> r      FALSE FALSE FALSE FALSE FALSE #> s       TRUE FALSE FALSE FALSE FALSE #> t       TRUE FALSE FALSE FALSE FALSE #>  #> $centroids #>   ID 206Pb/204Pb 207Pb/204Pb 208Pb/204Pb #> 1  A    18.90676    15.63670    38.68651 #> 2  B    18.49755    15.55502    37.49381 #> 3  C    18.73894    15.57353    38.62651 #> 4  D    18.47097    15.58188    38.38394 #>  #> $distances #>           A         B         C          D #> a 0.3467945 1.0100437 0.2557936 0.27944308 #> b 0.5774481 0.7495366 0.4305455 0.19930889 #> c 0.5071899 0.9692208 0.3286081 0.07940771 #> d 0.3930040 1.0215753 0.2334398 0.17040417 #> e 0.3636865 1.0374460 0.2687828 0.28295426 #> f 0.5710444 1.0714041 0.3831217 0.24319115 #> g 0.3687799 1.0232475 0.1855639 0.18551396 #> h 0.5122015 0.8214975 0.3820567 0.16727042 #> i 0.5707212 0.8898764 0.3921051 0.05925920 #> j 0.5694056 0.9690502 0.4517148 0.27574097 #> k 0.4107953 0.8812797 0.2777982 0.19693902 #> l 0.4329620 0.9085274 0.3205349 0.21528808 #> m 0.3588225 0.9118006 0.2644440 0.27353803 #> n 0.3146948 1.0046191 0.2395313 0.30350096 #> o 0.5463120 0.7681217 0.4067310 0.16267856 #> p 0.3810937 1.0223545 0.2278692 0.18371364 #> q 0.4472888 1.0967249 0.3143663 0.26011339 #> r 0.8274133 0.6461316 0.6971180 0.38489301 #> s 0.3634613 1.0412516 0.1787841 0.21774540 #> t 0.1178420 1.1647764 0.1506870 0.43952183 #>   # cleanup rm(df, ref)"},{"path":"https://archaeothommy.github.io/ASTR/news/index.html","id":"astr-development-version","dir":"Changelog","previous_headings":"","what":"ASTR (development version)","title":"ASTR (development version)","text":"Initial CRAN submission.","code":""}]
