<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Oxide conversion functions — oxide_conversion • ASTR</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Oxide conversion functions — oxide_conversion"><meta name="description" content="Convert between element and oxide weight percent (oxide%) compositions using
pre-compiled conversion factors."><meta property="og:description" content="Convert between element and oxide weight percent (oxide%) compositions using
pre-compiled conversion factors."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ASTR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/KDE2_vignette.html">Binary plot with kernel density estimation</a></li>
    <li><a class="dropdown-item" href="../articles/VG.ASTR.Conventions.explained.html">Data conventions explained</a></li>
    <li><a class="dropdown-item" href="../articles/VG.ASTRschema.0.0.2.html">ASTR schema: Naming conventions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Oxide conversion functions</h1>

      <div class="d-none name"><code>oxide_conversion.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Convert between element and oxide weight percent (oxide%) compositions using
pre-compiled conversion factors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">element_to_oxide</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">elements</span>,</span>
<span>  <span class="va">oxide_preference</span>,</span>
<span>  which_concentrations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"major"</span>, <span class="st">"minor"</span>, <span class="st">"no_trace"</span><span class="op">)</span>,</span>
<span>  normalise <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">oxide_to_element</span><span class="op">(</span><span class="va">df</span>, <span class="va">oxides</span>, normalise <span class="op">=</span> <span class="cn">FALSE</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Data frame with compositional data.</p></dd>


<dt id="arg-elements-oxides">elements, oxides<a class="anchor" aria-label="anchor" href="#arg-elements-oxides"></a></dt>
<dd><p>Character vector with the chemical symbols of the
elements or oxides that should be converted.</p></dd>


<dt id="arg-oxide-preference">oxide_preference<a class="anchor" aria-label="anchor" href="#arg-oxide-preference"></a></dt>
<dd><p>String that controls which oxide should be used if an
element forms more than one oxide. Allowed values are: <code>reducing</code>,
<code>oxidising</code>, <code>ask</code>, or a named vector mapping the specific oxide to its
element. See details for further information.</p></dd>


<dt id="arg-which-concentrations">which_concentrations<a class="anchor" aria-label="anchor" href="#arg-which-concentrations"></a></dt>
<dd><p>Character string that determines by concentration
which of the <code>elements</code> or <code>oxides</code> are converted. Allowed values are:</p><ul><li><p><code>all</code> (convert all elements or oxides; the default)</p></li>
<li><p><code>major</code> (convert elements or oxides with concentrations &gt;= 1 wt%)</p></li>
<li><p><code>minor</code> (convert elements or concentrations between 0.1 and 1 wt%).</p></li>
<li><p><code>no_trace</code> (convert elements or oxides with concentration &gt;=0.1 wt%)</p></li>
</ul></dd>


<dt id="arg-normalise">normalise<a class="anchor" aria-label="anchor" href="#arg-normalise"></a></dt>
<dd><p>If <code>TRUE</code>, converted concentrations will be normalised to
100%. Default to <code>FALSE</code>.</p></dd>


<dt id="arg-drop">drop<a class="anchor" aria-label="anchor" href="#arg-drop"></a></dt>
<dd><p>If <code>FALSE</code>, the default, columns with unconverted values are
kept. If <code>TRUE</code>, columns with unconverted values are dropped. Dropping
column could result in loss of information as this will also drop
columns with values excluded from conversion by the parameter
<code>which_concentrations</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The original data frame with the converted concentrations</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the dataset includes already an element and its respective oxide,
the conversion leaves the column of the respective oxide or element
unaffected.</p>
<p>In <code>element_to_oxide()</code>, the parameter <code>oxide_preference</code> controls the
behaviour of the function if the element forms more than one oxide:</p><ul><li><p><code>oxidising</code>: Use the oxide with the highest oxidation state of the element
(e.g., <code>Fe2O3</code>)</p></li>
<li><p><code>reducing</code>: Use the oxide with the lowest oxidation state of the element
(e.g., <code>FeO</code>)</p></li>
<li><p><code>ask</code>: The user is asked for each element which oxide should be used.</p></li>
<li><p>named vector: A named vector mapping the oxides to be used to the
elements (e.g., <code>c(Fe = "FeO", Cu = "Cu2O")</code>)</p></li>
</ul><p>In <code>oxide_to_element()</code>, conversions from different oxides to the same
element (e.g., Fe<sub>2</sub>O<sub>3</sub> and FeO to Fe) result in one column for the element
with the sum of all converted values of the respective element.</p>
<p>Conversion factors are pre-compiled for a wide range of oxides.
consequently, conversion is restricted to the oxides on this list. If you
encounter an oxide that is currently not included, please reach out to the
package maintainers or create a pull request in the <a href="https://github.com/archaeothommy/ASTR" class="external-link">package's GitHub repo</a> to add it.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example data frame with element weight percents</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="st">"Sample1"</span>, Si <span class="op">=</span> <span class="fl">45</span>, Fe <span class="op">=</span> <span class="fl">50</span>, Al <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select elements by oxide_preference</span></span></span>
<span class="r-in"><span><span class="fu">element_to_oxide</span><span class="op">(</span><span class="va">df</span>, elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Si"</span>, <span class="st">"Fe"</span>, <span class="st">"Al"</span><span class="op">)</span>, oxide_preference <span class="op">=</span> <span class="st">"oxidising"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ID Si Fe Al     SiO2   Fe2O3    Al2O3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Sample1 45 50  5 96.26789 71.4867 9.447131</span>
<span class="r-in"><span><span class="fu">element_to_oxide</span><span class="op">(</span><span class="va">df</span>, elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fe"</span>, <span class="st">"Al"</span><span class="op">)</span>, oxide_preference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Fe <span class="op">=</span> <span class="st">"FeO"</span>, Al <span class="op">=</span> <span class="st">"Al2O3"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ID Si Fe Al     FeO    Al2O3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Sample1 45 50  5 71.4867 9.447131</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">element_to_oxide</span><span class="op">(</span><span class="va">df</span>, elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Si"</span>, <span class="st">"Fe"</span>, <span class="st">"Al"</span><span class="op">)</span>, oxide_preference <span class="op">=</span> <span class="st">"ask"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Loss of information when converting a subset 'which_concentration' and 'drop = TRUE'</span></span></span>
<span class="r-in"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="st">"feldspar"</span>, Na <span class="op">=</span> <span class="fl">8.77</span>, Al <span class="op">=</span> <span class="fl">10.29</span>, Si <span class="op">=</span> <span class="fl">32.13</span>, Ba <span class="op">=</span> <span class="fl">0.3</span>, Sr <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">element_to_oxide</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">df2</span>,</span></span>
<span class="r-in"><span>  elements <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df2</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  which_concentration <span class="op">=</span> <span class="st">"major"</span>,</span></span>
<span class="r-in"><span>  oxide_preference <span class="op">=</span> <span class="st">"reducing"</span>,</span></span>
<span class="r-in"><span>  drop <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ID     Na2O     AlO     SiO2 BaO SrO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 feldspar 11.82157 19.4422 68.73527  NA  NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Conversions are reversible</span></span></span>
<span class="r-in"><span><span class="va">oxides</span> <span class="op">&lt;-</span> <span class="fu">element_to_oxide</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">df</span>,</span></span>
<span class="r-in"><span>  elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  oxide_preference <span class="op">=</span> <span class="st">"oxidising"</span>,</span></span>
<span class="r-in"><span>  drop <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  normalise <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">elements</span> <span class="op">&lt;-</span> <span class="fu">oxide_to_element</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">oxides</span>,</span></span>
<span class="r-in"><span>  oxides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">oxides</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  drop <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  normalise <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">elements</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Conversion from oxide to element summarises columns converting to the same element</span></span></span>
<span class="r-in"><span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Fe2O3 <span class="op">=</span> <span class="fl">20</span>, FeO <span class="op">=</span> <span class="fl">20</span>, Cr2O3 <span class="op">=</span> <span class="fl">15</span>, CrO2 <span class="op">=</span> <span class="fl">15</span>, CuO <span class="op">=</span> <span class="fl">20</span>, Cu2O <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">oxide_to_element</span><span class="op">(</span><span class="va">df3</span>, oxides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df3</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Fe       Cr       Cu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 29.5348 19.54877 33.74117</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rose, Andrea Acevedo Mejia, Gilberto Artioli, María Florencia Becerra, Adam Kevin Benfer, Lisa Bellemère, Thomas Edward Birch, Karan Desai, Paolo d’Imporzano, Tzilla Eshel, Valerio Gentile, Sabine Klein, Catherine Klesner, Kathryn Murphy, Ben Marwick, Stephen Merkel, Marco Daniele Pelizzari, Alexandra Rodler, Benjamin Sabatini, Clemens Schmid, Berber van der Meulen-van der Veen, Chen Wang, Katrin Julia Westner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

