<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Comparing Isotope Samples to Reference Data in 3D Space — pointcloud_distribution • ASTR</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparing Isotope Samples to Reference Data in 3D Space — pointcloud_distribution"><meta name="description" content="This package compares isotope samples to reference data in 3D space
to identify isotopic consistency and the possibility of mixing between sources."><meta property="og:description" content="This package compares isotope samples to reference data in 3D space
to identify isotopic consistency and the possibility of mixing between sources."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ASTR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/VG.ASTR.Conventions.explained.html">Data conventions explained</a></li>
    <li><a class="dropdown-item" href="../articles/VG.ASTRschema.0.0.2.html">ASTR schema: Naming conventions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Comparing Isotope Samples to Reference Data in 3D Space</h1>

      <div class="d-none name"><code>pointcloud_distribution.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This package compares isotope samples to reference data in 3D space
to identify isotopic consistency and the possibility of mixing between sources.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pointcloud_distribution</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">ref</span>,</span>
<span>  isotope_sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"206Pb/204Pb"</span>, <span class="st">"207Pb/204Pb"</span>, <span class="st">"208Pb/204Pb"</span><span class="op">)</span>,</span>
<span>  isotope_ref <span class="op">=</span> <span class="va">isotope_sample</span>,</span>
<span>  id_sample <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>  id_ref <span class="op">=</span> <span class="va">id_sample</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Working data, with 206Pb/204Pb, 207Pb/204Pb, 208Pb/204Pb and ID</p></dd>


<dt id="arg-ref">ref<a class="anchor" aria-label="anchor" href="#arg-ref"></a></dt>
<dd><p>Reference data with 206Pb/204Pb, 207Pb/204Pb, 208Pb/204Pb and Group</p></dd>


<dt id="arg-isotope-sample-isotope-ref">isotope_sample, isotope_ref<a class="anchor" aria-label="anchor" href="#arg-isotope-sample-isotope-ref"></a></dt>
<dd><p>3  Isotpe snf Sample ID ot Refrence Group,
names. Default c("206Pb/204Pb", "207Pb/204Pb", "208Pb/204Pb", "ID").</p></dd>


<dt id="arg-id-sample-id-ref">id_sample, id_ref<a class="anchor" aria-label="anchor" href="#arg-id-sample-id-ref"></a></dt>
<dd><p>colum name with the sample ID and Identifyier for
reference groups. Default "ID".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> of three elements:</p>
<dl><dt>in_hull</dt>
<dd><p><code>logical</code>. A Boolean value indicating the <strong>inclusion</strong>
of the working data (sample points) within the convex <strong>hull</strong> of the reference data.</p></dd>

<dt>centroids</dt>
<dd><p><code>data.frame</code>. The coordinates of the <strong>centroids</strong>
(mean values) for each defined reference group.</p></dd>

<dt>distances</dt>
<dd><p><code>matrix</code>. A distance <strong>matrix</strong> where rows represent the samples
and columns represent the reference <strong>centroids</strong>, containing the distance of each sample from each centroid.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Calculates the <strong>Convex Hull</strong> for the complete set of reference points and
all specified <strong>subgroups</strong>.
It determines the inclusion or exclusion of sample <strong>Isotope values</strong>
within these hulls.</p>
<p>The function also calculates:</p><ul><li><p>The <strong>centroid</strong> of each reference subgroup as <strong>mean value</strong> of points within each vertex group.</p></li>
<li><p>The <strong>distance</strong> from each sample point to every subgroup centroid.</p></li>
</ul><div class="section">
<h3 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a></h3>


<p>Inclusion within a hull suggests the sample is part of the <strong>mixing group</strong>
(main hull) or is
highly likely to be the specific <strong>end member</strong> (subgroup hull). The distance
calculation provides a measure of proximity to these end member centers.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Creaete Synthetic Data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">24021999</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"206Pb/204Pb"</span>,<span class="st">"207Pb/204Pb"</span>,<span class="st">"208Pb/204Pb"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Create Synthetic Reference data</span></span></span>
<span class="r-in"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">rand_iso</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">18.3</span>, <span class="fl">19</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15.5</span>, <span class="fl">15.9</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">37.5</span>, <span class="fl">39</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">list_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">groups</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu">rand_iso</span><span class="op">(</span><span class="op">)</span>,  \<span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">{</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="va">g</span>, <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ls</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">iso</span></span></span>
<span class="r-in"><span>  <span class="va">ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ls</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ls</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="va">x</span></span></span>
<span class="r-in"><span>  <span class="va">ls</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">list_df</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Create working data</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu">rand_iso</span><span class="op">(</span><span class="op">)</span>,  \<span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="va">g</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">iso</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">list_df</span>, <span class="va">iso</span>, <span class="va">groups</span>, <span class="va">rand_iso</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Run Pointcloud_distribution</span></span></span>
<span class="r-in"><span><span class="fu">pointcloud_distribution</span><span class="op">(</span><span class="va">df</span>, <span class="va">ref</span>, isotope_sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"206Pb/204Pb"</span>,</span></span>
<span class="r-in"><span><span class="st">"207Pb/204Pb"</span>, <span class="st">"208Pb/204Pb"</span><span class="op">)</span>, id_sample <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $in_hull</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   hull_inout     A     B     C     D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a      FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c       TRUE FALSE FALSE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e      FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f      FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i       TRUE FALSE FALSE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j      FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q      FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r      FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t       TRUE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $centroids</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID 206Pb/204Pb 207Pb/204Pb 208Pb/204Pb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  A    18.90676    15.63670    38.68651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  B    18.49755    15.55502    37.49381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  C    18.73894    15.57353    38.62651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  D    18.47097    15.58188    38.38394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           A         B         C          D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 0.3467945 1.0100437 0.2557936 0.27944308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0.5774481 0.7495366 0.4305455 0.19930889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 0.5071899 0.9692208 0.3286081 0.07940771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 0.3930040 1.0215753 0.2334398 0.17040417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 0.3636865 1.0374460 0.2687828 0.28295426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0.5710444 1.0714041 0.3831217 0.24319115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 0.3687799 1.0232475 0.1855639 0.18551396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 0.5122015 0.8214975 0.3820567 0.16727042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 0.5707212 0.8898764 0.3921051 0.05925920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 0.5694056 0.9690502 0.4517148 0.27574097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k 0.4107953 0.8812797 0.2777982 0.19693902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l 0.4329620 0.9085274 0.3205349 0.21528808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m 0.3588225 0.9118006 0.2644440 0.27353803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n 0.3146948 1.0046191 0.2395313 0.30350096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o 0.5463120 0.7681217 0.4067310 0.16267856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p 0.3810937 1.0223545 0.2278692 0.18371364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q 0.4472888 1.0967249 0.3143663 0.26011339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r 0.8274133 0.6461316 0.6971180 0.38489301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s 0.3634613 1.0412516 0.1787841 0.21774540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t 0.1178420 1.1647764 0.1506870 0.43952183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># cleanup</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">ref</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rose Thomas, Acevedo Mejia Andrea, Artioli Gilberto, Becerra María Florencia, Benfer Adam Kevin, Bellemère Lisa, Birch Thomas Edward, Desai Karan, d’Imporzano Paolo, Eshel Tzilla, Gentile Valerio, Klein Sabine, Klesner Catherine, Murphy Kathryn, Marwick Ben, Merkel Stephen, Pelizzari Marco Daniele, Rodler Alexandra, Sabatini Benjamin, Schmid Clemens, van der Meulen-van der Veen Berber, Wang Chen, Westner Katrin Julia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

